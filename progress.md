# 自习座位预约系统开发进度

## 用户故事

### 管理员相关用户故事

1. **自习室管理**
   - 作为管理员，我希望能够添加自习室，以便增加可用的自习空间
   - 作为管理员，我希望能够修改自习室信息，以便更新自习室状态
   - 作为管理员，我希望能够删除自习室，以便移除不再使用的自习室
   - 作为管理员，我希望能够设置自习室的开放时间，以满足不同场地的使用需求
   - 作为管理员，我希望能够设置自习室的归属（全校或特定院系），以控制访问权限

2. **座位管理**
   - 作为管理员，我希望能够添加座位，以便增加自习室的座位资源
   - 作为管理员，我希望能够修改座位信息，以更新座位状态
   - 作为管理员，我希望能够删除座位，以移除不可用的座位
   - 作为管理员，我希望能够标记座位的特殊属性（如靠近插座），以便学生筛选

3. **签到管理**
   - 作为管理员，我希望能够管理每日的签到二维码/编码，以便学生签到验证
   - 作为管理员，我希望能够查看签到情况，以监控座位实际使用情况

4. **数据管理**
   - 作为管理员，我希望能够查看预约数据和统计信息，以优化资源配置
   - 作为管理员，我希望能够查看学生违约记录，以便实施管理措施
   - 作为管理员，我希望能够导出使用数据，以便进行离线分析

5. **系统管理**
   - 作为管理员，我希望能够调整系统参数（如最大预约时长），以适应不同场景需求
   - 作为管理员，我希望能够管理管理员账号，以分配管理权限
   - 作为管理员，我希望能够发布自习室临时关闭等通知，以应对突发情况

### 学生相关用户故事

1. **浏览与搜索**
   - 作为学生，我希望能够浏览所有对我开放的自习室，以选择合适的自习场所
   - 作为学生，我希望能够查看自习室座位的可用情况，以便预约座位
   - 作为学生，我希望能够按时间段筛选可用座位，以找到合适的自习时间
   - 作为学生，我希望能够按特殊属性（如靠近插座）筛选座位，以满足特定需求
   - 作为学生，我希望能够搜索特定的自习室或座位，以快速定位熟悉的位置

2. **预约管理**
   - 作为学生，我希望能够预约座位，以保证自习位置
   - 作为学生，我希望能够一次性预约多个连续时间段，以便长时间学习
   - 作为学生，我希望能够取消预约，以便在计划变更时释放资源
   - 作为学生，我希望能够延长预约时间（如果后续时间段可用），以便继续学习
   - 作为学生，我希望能够查看我当前的预约，以了解我的自习安排

3. **签到与使用**
   - 作为学生，我希望能够通过扫码签到，以确认我已到达预约座位
   - 作为学生，我希望能够通过输入编码签到，以在不方便扫码的情况下完成签到
   - 作为学生，我希望能够提前结束使用，以便释放不再需要的座位

4. **个人中心**
   - 作为学生，我希望能够查看我的历史预约记录，以了解我的自习习惯
   - 作为学生，我希望能够查看我的违约记录，以了解自己的预约履行情况
   - 作为学生，我希望能够收藏常用自习室或座位，以便快速预约
   - 作为学生，我希望能够设置个人偏好，以获得更符合需求的推荐

5. **通知与提醒**
   - 作为学生，我希望能够收到预约前的提醒通知，以避免忘记预约时间
   - 作为学生，我希望能够收到迟到提醒，以避免因忘记签到而被取消预约
   - 作为学生，我希望能够收到自习室临时关闭等通知，以便及时调整计划

### 系统相关用户故事

1. **通知系统**
   - 系统应在预约前15分钟发送提醒通知
   - 系统应在预约时间10分钟后发送迟到提醒
   - 系统应在预约时间15分钟后自动取消未签到的预约并记录违约

2. **安全与认证**
   - 系统应提供用户认证和权限控制机制
   - 系统应保护用户隐私和数据安全

3. **数据处理**
   - 系统应生成每日的签到编码/二维码
   - 系统应记录和分析座位利用数据
   - 系统应提供统计报表功能

## 开发规划

### 阶段一：项目初始化与基础架构

1. **前端初始化**
   - 创建微信小程序项目
   - 设计UI/UX原型
   - 实现基础组件库
   - 配置路由和全局状态管理

2. **后端初始化**
   - 搭建Spring Boot框架
   - 配置MyBatis-Plus
   - 设计并创建数据库结构
   - 实现用户认证系统
   - 配置开发环境

3. **基础功能实现**
   - 管理员和学生登录/注册
   - 基础数据模型和API
   - 前后端通信测试

### 阶段二：核心功能开发

1. **管理员功能**
   - 自习室管理（增删改查）
   - 座位管理（增删改查）
   - 签到码生成系统
   - 基础统计数据展示

2. **学生功能**
   - 自习室和座位浏览
   - 基础预约功能
   - 签到功能
   - 个人中心基础功能

3. **系统功能**
   - 基础通知系统
   - 数据验证和错误处理
   - 预约冲突处理机制

### 阶段三：高级功能与优化

1. **管理员高级功能**
   - 高级数据分析和可视化
   - 批量操作功能
   - 系统参数配置

2. **学生高级功能**
   - 高级搜索筛选
   - 预约历史与再次预约
   - 座位收藏功能
   - 延长预约功能

3. **系统高级功能**
   - 完整的通知与提醒系统
   - 违约记录与处理机制
   - 性能优化
   - 安全加固

### 阶段四：测试与部署

1. **测试**
   - 单元测试
   - 集成测试
   - 用户测试
   - 性能测试

2. **部署**
   - 后端服务部署
   - 微信小程序发布
   - 数据库配置与优化
   - 监控系统部署

3. **文档与培训**
   - 用户手册编写
   - 管理员指南编写
   - 系统维护文档编写

## 前后端任务拆分

### 前端任务（微信小程序）

1. **UI设计与实现**
   - 页面布局设计
   - 组件库开发
   - 主题与样式设置

2. **用户认证页面**
   - 登录页面
   - 授权页面
   - 个人信息页面

3. **自习室浏览**
   - 自习室列表页
   - 自习室详情页
   - 筛选与搜索功能

4. **座位预约**
   - 座位选择界面
   - 时间段选择界面
   - 预约确认界面
   - 预约管理界面

5. **签到系统**
   - 扫码签到功能
   - 手动输入编码签到
   - 签到状态展示

6. **个人中心**
   - 当前预约展示
   - 历史预约记录
   - 违约记录
   - 个人设置

7. **通知系统**
   - 消息列表页
   - 消息详情页
   - 订阅消息授权

### 后端任务（Spring Boot + MyBatis-Plus）

1. **项目结构搭建**
   - Spring Boot项目初始化
   - 整合MyBatis-Plus
   - 配置文件设置
   - 项目分层（Controller, Service, Mapper, Entity等）

2. **用户认证系统**
   - JWT认证实现
   - Spring Security配置
   - 权限控制
   - 用户角色管理

3. **自习室管理**
   - 自习室实体设计
   - 自习室CRUD接口
   - 自习室查询与筛选接口
   - 自习室权限验证

4. **座位管理**
   - 座位实体设计
   - 座位CRUD接口
   - 座位查询与筛选接口
   - 座位状态管理

5. **预约系统**
   - 预约实体设计
   - 预约创建接口
   - 预约取消接口
   - 预约延长接口
   - 预约冲突检测
   - 预约状态管理

6. **签到系统**
   - 签到实体设计
   - 签到码生成接口
   - 签到验证接口
   - 签到状态管理
   - 违约自动处理

7. **通知系统**
   - 消息实体设计
   - Spring定时任务
   - 微信订阅消息接口集成
   - 通知发送服务

8. **数据分析**
   - 统计数据接口
   - 报表生成
   - 数据导出功能

9. **系统管理**
   - 系统参数实体设计
   - 系统参数配置接口
   - 管理员账号管理接口
   - 系统日志实现

## 需要注意的事项

1. **微信小程序相关**
   - 微信登录与授权流程需特别注意
   - 订阅消息有次数和类型限制
   - 小程序审核可能需要多次修改
   - 小程序页面跳转和数据传递有特定限制

2. **后端安全相关**
   - 接口权限控制必须严格实现
   - 数据库查询需防止SQL注入（使用MyBatis-Plus参数绑定）
   - API请求需做频率限制，防止恶意请求
   - 敏感数据加密存储
   - Spring Security正确配置

3. **业务逻辑相关**
   - 预约冲突检测需要严格测试
   - 时间处理需考虑时区问题
   - 签到和违约处理的时间计算要准确
   - 并发预约可能导致的问题需要解决

4. **性能相关**
   - 预约高峰期系统负载可能较大
   - 数据库查询优化（索引、缓存等）
   - 长期运行的数据清理与归档策略
   - 服务器资源监控与扩展策略

5. **用户体验相关**
   - 预约流程应尽量简化
   - 错误提示应友好明确
   - 网络不稳定情况的处理
   - 页面加载和响应速度优化

# 任务清单

## 初始化阶段任务

### 环境搭建
- [x] 安装JDK 11
- [x] 安装Maven 3.6+
- [x] 安装MySQL 8.0+
- [x] 安装微信开发者工具
- [x] 安装开发IDE（IntelliJ IDEA/Eclipse）

### 后端初始化
- [x] 创建Spring Boot项目（使用Spring Initializr）
- [x] 配置pom.xml添加所需依赖（Spring Web, MyBatis-Plus, MySQL, JWT等）
- [x] 创建项目基础结构（controller/service/mapper/entity/dto等包）
- [x] 配置application.yml（数据库连接、服务器端口等）
- [x] 配置MyBatis-Plus
- [x] 配置跨域支持
- [x] 创建统一响应格式类
- [x] 创建全局异常处理器

### 数据库设计与初始化
- [ ] 设计用户表（User/Admin/Student）
- [ ] 设计自习室表（StudyRoom）
- [ ] 设计座位表（Seat）
- [ ] 设计预约表（Reservation）
- [ ] 设计签到表（CheckIn）
- [ ] 设计系统参数表（SystemParam）
- [ ] 设计通知消息表（Notification）
- [ ] 编写数据库初始化脚本（init.sql）
- [ ] 创建数据库并导入初始数据

### 前端初始化
- [ ] 创建微信小程序项目
- [ ] 创建基础UI组件
- [ ] 配置小程序项目结构和路由
- [ ] 配置全局状态管理
- [ ] 创建API请求封装模块
- [ ] 配置请求拦截器（添加token等）

## 核心功能实现任务

### 用户认证模块
- [ ] 后端：创建User/Admin/Student实体类
- [ ] 后端：实现JWT工具类
- [ ] 后端：配置Spring Security
- [ ] 后端：实现用户登录接口
- [ ] 后端：实现微信授权登录接口
- [ ] 后端：实现获取用户信息接口
- [ ] 前端：实现登录页面
- [ ] 前端：实现微信授权登录流程
- [ ] 前端：实现获取用户信息功能
- [ ] 单元测试：用户认证服务测试
- [ ] 单元测试：JWT工具类测试
- [ ] 集成测试：用户认证流程测试

### 自习室管理模块
- [ ] 后端：创建StudyRoom实体类及关联类
- [ ] 后端：实现自习室CRUD接口
- [ ] 后端：实现自习室查询与筛选接口
- [ ] 后端：实现自习室权限验证
- [ ] 前端：实现自习室列表页面
- [ ] 前端：实现自习室详情页面
- [ ] 前端：实现自习室筛选与搜索功能
- [ ] 前端：实现管理员自习室管理页面
- [ ] 单元测试：自习室服务测试
- [ ] 集成测试：自习室管理流程测试

### 座位管理模块
- [ ] 后端：创建Seat实体类及关联类
- [ ] 后端：实现座位CRUD接口
- [ ] 后端：实现座位查询与筛选接口
- [ ] 后端：实现座位状态管理
- [ ] 前端：实现座位布局可视化
- [ ] 前端：实现座位选择界面
- [ ] 前端：实现座位筛选功能（靠近插座等）
- [ ] 前端：实现管理员座位管理页面
- [ ] 单元测试：座位服务测试
- [ ] 集成测试：座位管理流程测试

### 预约系统模块
- [ ] 后端：创建Reservation实体类及关联类
- [ ] 后端：实现预约创建接口
- [ ] 后端：实现预约取消接口
- [ ] 后端：实现预约延长接口
- [ ] 后端：实现预约冲突检测
- [ ] 后端：实现预约状态管理
- [ ] 前端：实现时间段选择界面
- [ ] 前端：实现预约确认界面
- [ ] 前端：实现预约管理界面
- [ ] 前端：实现预约取消功能
- [ ] 前端：实现预约延长功能
- [ ] 单元测试：预约服务测试
- [ ] 单元测试：预约冲突检测测试
- [ ] 集成测试：预约流程测试

### 签到系统模块
- [ ] 后端：创建CheckIn实体类及关联类
- [ ] 后端：实现签到码生成接口
- [ ] 后端：实现签到验证接口
- [ ] 后端：实现签到状态管理
- [ ] 后端：实现违约自动处理
- [ ] 前端：实现扫码签到功能
- [ ] 前端：实现手动输入编码签到
- [ ] 前端：实现签到状态展示
- [ ] 单元测试：签到服务测试
- [ ] 单元测试：签到码生成测试
- [ ] 集成测试：签到流程测试

### 通知系统模块
- [ ] 后端：创建Notification实体类及关联类
- [ ] 后端：配置Spring Task定时任务
- [ ] 后端：实现预约前提醒功能
- [ ] 后端：实现迟到提醒功能
- [ ] 后端：实现微信订阅消息集成
- [ ] 前端：实现消息列表页面
- [ ] 前端：实现消息详情页面
- [ ] 前端：实现订阅消息授权
- [ ] 单元测试：通知服务测试
- [ ] 单元测试：定时任务测试
- [ ] 集成测试：通知发送流程测试

### 数据分析模块
- [ ] 后端：实现统计数据接口
- [ ] 后端：实现报表生成功能
- [ ] 后端：实现数据导出功能
- [ ] 前端：实现数据可视化展示
- [ ] 前端：实现管理员数据分析页面
- [ ] 前端：实现数据导出功能
- [ ] 单元测试：数据统计服务测试
- [ ] 单元测试：报表生成测试
- [ ] 集成测试：数据分析流程测试

### 系统管理模块
- [ ] 后端：创建SystemParam实体类
- [ ] 后端：实现系统参数配置接口
- [ ] 后端：实现管理员账号管理接口
- [ ] 后端：实现系统日志记录
- [ ] 前端：实现系统参数配置页面
- [ ] 前端：实现管理员账号管理页面
- [ ] 前端：实现日志查看页面
- [ ] 单元测试：系统参数服务测试
- [ ] 单元测试：管理员服务测试
- [ ] 集成测试：系统管理流程测试

## 高级功能实现任务

### 个人中心模块
- [ ] 后端：实现个人预约历史查询
- [ ] 后端：实现违约记录查询
- [ ] 后端：实现个人偏好设置
- [ ] 前端：实现个人中心页面
- [ ] 前端：实现历史预约记录页面
- [ ] 前端：实现违约记录页面
- [ ] 前端：实现个人设置页面
- [ ] 单元测试：个人中心服务测试
- [ ] 集成测试：个人中心功能测试

### 高级搜索与筛选
- [ ] 后端：实现复合条件查询接口
- [ ] 前端：实现高级搜索界面
- [ ] 前端：实现筛选条件组合功能
- [ ] 单元测试：高级搜索服务测试
- [ ] 集成测试：高级搜索功能测试

### 收藏与快速预约
- [ ] 后端：创建Favorite实体类
- [ ] 后端：实现收藏相关接口
- [ ] 后端：实现快速预约接口
- [ ] 前端：实现收藏功能
- [ ] 前端：实现快速预约功能
- [ ] 单元测试：收藏服务测试
- [ ] 集成测试：收藏与快速预约功能测试

## 测试与部署任务

### 单元测试
- [ ] 配置测试环境（H2内存数据库）
- [ ] 实现Mock服务和工具类
- [ ] 编写Service层单元测试
- [ ] 编写Mapper层单元测试
- [ ] 编写工具类单元测试
- [ ] 运行并修复单元测试问题

### 集成测试
- [ ] 配置集成测试环境
- [ ] 编写Controller层集成测试
- [ ] 编写端到端流程测试
- [ ] 测试微信API集成
- [ ] 运行并修复集成测试问题

### 性能测试
- [ ] 设计性能测试场景
- [ ] 实现性能测试脚本
- [ ] 执行性能测试并收集数据
- [ ] 分析性能瓶颈并优化
- [ ] 验证优化效果

### 部署准备
- [ ] 准备生产环境配置文件
- [ ] 编写部署文档
- [ ] 创建数据库备份与恢复脚本
- [ ] 准备监控脚本
- [ ] 创建CI/CD配置（可选）

### 上线部署
- [ ] 部署后端服务
- [ ] 发布微信小程序
- [ ] 配置生产环境数据库
- [ ] 配置域名和HTTPS
- [ ] 配置微信服务器域名
- [ ] 设置监控系统

## 文档与培训

### 用户文档
- [ ] 编写学生用户手册
- [ ] 编写管理员操作指南
- [ ] 创建FAQ文档

### 开发文档
- [ ] 编写API文档
- [ ] 编写数据库设计文档
- [ ] 编写系统架构文档
- [ ] 编写开发环境搭建指南

### 运维文档
- [ ] 编写系统部署文档
- [ ] 编写备份与恢复文档
- [ ] 编写故障处理指南
- [ ] 编写监控与告警指南 